<script src="/socket.io/socket.io.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/TweenLite.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/easing/EasePack.min.js"></script>
{{#unless isProd}}
	<script src="/assets/scripts/three.min.js"></script>
	<script src="/assets/scripts/main.js"></script>
	<link href="/assets/styles/main.css" type="text/css" rel="stylesheet" />
	<script>
		window.init();
	</script>
{{/unless}}
{{#if isProd}}
<script>

	(function(win, doc){

		// If init is called before JavaScript is loaded, global `isReady` boolean is set.
		win.init = function(){ win.isReady = true; };

		var MOBILE_ASSET = 'mobile',
			hasLocalStorage = 'localStorage' in win && win['localStorage'] !== null,
			localStrg,
			jsFile = '/assets/scripts/main.js',
			JS_FILE = 'JS_FILE',
			JS_DATA = 'JS_DATA',

			threeFile = '/assets/scripts/three.min.js',
			THREE_FILE = 'THREE_FILE',
			THREE_DATA = 'THREE_DATA',

			cssFile = '/assets/styles/main.css',
			CLASS_INLINE_CSS = 'js-inlineStyle',
			CSS_FILE = 'CSS_FILE',
			CSS_DATA = 'CSS_DATA';


		loadFile(threeFile, THREE_FILE, THREE_DATA, 'script', function(){
			loadFile(jsFile, JS_FILE, JS_DATA, 'script', function(){
				loadFile(cssFile, CSS_FILE, CSS_DATA, 'style', win.init);
			});
		});

		function loadFile(url, keyFile, keyData, tagName, callback) {

			callback = callback || function(){};

			if(assetFile === MOBILE_ASSET && url === threeFile) {

				callback();
				
			} else if(hasLocalStorage) {

				localStrg = localStorage;

				if(localStrg.getItem(keyFile) !== url) {

					localStrg.setItem(keyFile, url);

					load();

				} else {

					handleFile(tagName, localStrg.getItem(keyData));

					callback();
				}

			} else {

				load();
			}

			function load() {

				loadUrl(url, function(response) {

					if(hasLocalStorage) {

						localStrg.setItem(keyData, response);
					}

					handleFile(tagName, response);

					callback();
				});
			}
		}

		function handleFile(tagName, content) {

			var el;

			if(tagName) {

				el = doc.createElement(tagName);

				if(tagName === 'style') {

					el.className = CLASS_INLINE_CSS;
				}
				el.innerHTML = content;
				doc.body.appendChild(el);

			} else {

				doc.body.innerHTML += content;
			}
		}

		function loadUrl(url, callback) {

			var request = new XMLHttpRequest();

			request.open('GET', url, true);
			request.onreadystatechange = function () {

				if (request.readyState != 4 || request.status != 200) {

					return

				} else {

					callback(request.responseText);
				}
			};
			request.send();
		}
	})(window, document);

</script>
{{/if}}